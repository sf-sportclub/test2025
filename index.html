<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Feedback</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- SweetAlert2 library for beautiful alerts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #01579b;
        }

        /* Background image with blur and fade effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://i.postimg.cc/dQfN4kHR/image.png');
            background-size: cover;
            background-position: center;
            filter: blur(3px);
            opacity: 0.8;
            z-index: -1;
        }

        .vote-card {
            transition: all 0.2s ease-in-out;
        }

        .vote-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        input[type="radio"]:checked+label .vote-card {
            border-color: #4f46e5;
            background-color: #eef2ff;
        }

        /* Updated Logo Styles */
        .logo {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 80px;
            height: auto;
            z-index: 10;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">
    <main class="flex-grow flex items-center justify-center p-4 relative">
        <img src="https://i.postimg.cc/q7fGWSWj/SF-Logo-2.png" alt="SF Logo" class="logo">

        <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-2xl">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">หลักสูตรที่คุณอยากให้จัดมากที่สุด</h1>
            <p class="text-center text-gray-600 mb-8">เสียงของคุณสำคัญ เลือกตัวเลือกที่ตรงใจที่สุด</p>

            <form id="voteForm" class="space-y-6">
                <div>
                    <label for="employeeId" class="block text-sm font-medium text-gray-700">รหัสพนักงาน</label>
                    <input type="text" id="employeeId" name="employeeId" required
                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>

                <div>
                    <label for="department" class="block text-sm font-medium text-gray-700">แผนก</label>
                    <select id="department" name="department" required
                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        <option value="" disabled selected>เลือกแผนก</option>
                        <option value="Accounting Division">Accounting Division</option>
                        <option value="Business Development">Business Development</option>
                        <option value="Human Resources">Human Resources</option>
                        <option value="Information Technology">Information Technology</option>
                        <option value="Leasing & Tenant">Leasing & Tenant</option>
                        <option value="Legal">Legal</option>
                        <option value="Local Area Marketing">Local Area Marketing</option>
                        <option value="Maintenance">Maintenance</option>
                        <option value="Management">Management</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Programming & film">Programming & film</option>
                        <option value="Operation">Operation</option>
                        <option value="Project">Project</option>
                        <option value="Purchasing">Purchasing</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">เลือกหลักสูตรที่ชื่นชอบ</label>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="relative flex items-center">
                            <input type="radio" id="vote1" name="vote" value="Work life Balance" class="hidden peer" required>
                            <label for="vote1" class="cursor-pointer w-full">
                                <div
                                    class="vote-card flex flex-col items-center justify-center p-6 border-2 border-gray-300 rounded-xl bg-white shadow-sm hover:bg-gray-50">
                                    <svg class="w-12 h-12 text-gray-600 mb-2" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span class="text-sm font-semibold text-gray-800 text-center">Work life
                                        Balance</span>
                                </div>
                            </label>
                        </div>

                        <div class="relative flex items-center">
                            <input type="radio" id="vote2" name="vote" value="AI Presentation" class="hidden peer">
                            <label for="vote2" class="cursor-pointer w-full">
                                <div
                                    class="vote-card flex flex-col items-center justify-center p-6 border-2 border-gray-300 rounded-xl bg-white shadow-sm hover:bg-gray-50">
                                    <svg class="w-12 h-12 text-gray-600 mb-2" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 19V6l12-3v13M9 19a2 2 0 002 2h4a2 2 0 002-2M9 19c-.387 0-.742-.164-.99-.45L11 21h2a2 2 0 002-2m0 0V5.786" />
                                    </svg>
                                    <span class="text-sm font-semibold text-gray-800 text-center">AI
                                        Presentation</span>
                                </div>
                            </label>
                        </div>

                        <div class="relative flex items-center">
                            <input type="radio" id="vote3" name="vote" value="Leadership" class="hidden peer">
                            <label for="vote3" class="cursor-pointer w-full">
                                <div
                                    class="vote-card flex flex-col items-center justify-center p-6 border-2 border-gray-300 rounded-xl bg-white shadow-sm hover:bg-gray-50">
                                    <svg class="w-12 h-12 text-gray-600 mb-2" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M17 20h-4a2 2 0 01-2-2V7m-4 11h4a2 2 0 002-2V7m-6 4H7" />
                                    </svg>
                                    <span class="text-sm font-semibold text-gray-800 text-center">Leadership</span>
                                </div>
                            </label>
                        </div>

                        <div class="relative flex items-center">
                            <input type="radio" id="vote4" name="vote" value="Communication" class="hidden peer">
                            <label for="vote4" class="cursor-pointer w-full">
                                <div
                                    class="vote-card flex flex-col items-center justify-center p-6 border-2 border-gray-300 rounded-xl bg-white shadow-sm hover:bg-gray-50">
                                    <svg class="w-12 h-12 text-gray-600 mb-2" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.804A12.016 12.016 0 0012 8c4.97 0 9 3.582 9 8z" />
                                    </svg>
                                    <span class="text-sm font-semibold text-gray-800 text-center">Communication</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div>
                    <button type="submit"
                        class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                        ส่งผลโหวต
                    </button>
                </div>
            </form>
        </div>
    </main>

    <footer class="bg-gray-100 py-4 text-center text-gray-500 text-sm">
        HRD - TRAINING
    </footer>

    <script>
        // Set your Google Apps Script Web App URL here
        // NOTE: Make sure the URL is deployed as a Web App (execute as 'me', access to 'anyone')
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbzuPAdQ95Nx11h9Zu3lgSGLOy3ILIwSmLDP-KWZtbL3TtKB58nbdXPS2ahEwAF39Hp_/exec';

        document.getElementById('voteForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            // Show a loading alert
            Swal.fire({
                title: 'กำลังบันทึกข้อมูล...',
                text: 'โปรดรอสักครู่',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            // Get form data
            const employeeId = document.getElementById('employeeId').value;
            const department = document.getElementById('department').value;
            const vote = document.querySelector('input[name="vote"]:checked')?.value;

            // Check if all required fields are filled, including the radio button
            if (!employeeId || !department || !vote) {
                Swal.fire({
                    icon: 'error',
                    title: 'ข้อผิดพลาด',
                    text: 'กรุณากรอกข้อมูลให้ครบถ้วน',
                    confirmButtonText: 'ตกลง',
                });
                return;
            }

            // Create the payload object to send to the Google Apps Script
            const payload = {
                employeeId: employeeId,
                department: department,
                vote: vote,
            };

            try {
                // The 'no-cors' mode is necessary for Google Apps Script to work without
                // a preflight request, but it means we cannot read the response from fetch.
                await fetch(GAS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    body: JSON.stringify(payload)
                });
                
                // If the fetch call completes without an error, show success message
                Swal.fire({
                    icon: 'success',
                    title: 'ส่งผลโหวตเรียบร้อย!',
                    text: 'ขอบคุณสำหรับความร่วมมือ',
                    confirmButtonText: 'ตกลง',
                }).then(() => {
                    // Reset the form after successful submission
                    document.getElementById('voteForm').reset();
                });

            } catch (error) {
                // If an error occurs during the fetch call, show an error message
                console.error('Fetch Error:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'ข้อผิดพลาดในการส่งข้อมูล',
                    text: 'กรุณาลองใหม่อีกครั้ง หรือติดต่อฝ่ายไอที',
                    confirmButtonText: 'ตกลง',
                });
            }
        });
    </script>
</body>
</html>
